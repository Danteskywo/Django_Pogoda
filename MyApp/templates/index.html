<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ü–æ–≥–æ–¥–∞</title>
    <style>
        .city-card {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        .city-card:hover {
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <h1>–ü–æ–≥–æ–¥–∞ –≤ –≥–æ—Ä–æ–¥–∞—Ö</h1>
    
    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≥–æ—Ä–æ–¥–∞ -->
    <form method="post">
        {% csrf_token %}
        {{ form.name }}
        <button type="submit" onclick="trackButtonClick('–î–æ–±–∞–≤–∏—Ç—å –≥–æ—Ä–æ–¥')">–î–æ–±–∞–≤–∏—Ç—å</button>
    </form>

    <!-- –°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É -->
    <a href="/stats/" onclick="trackButtonClick('–ü–µ—Ä–µ—Ö–æ–¥ –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>

    <!-- –°–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤ -->
    {% for city in all_info %}
    <div class="city-card" onclick="trackCityClick('{{ city.city }}', '{{ city.id }}')">
        <h3>{{ city.city }}</h3>
        <p>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ city.temp }}¬∞C</p>
        <img src="http://openweathermap.org/img/w/{{ city.icon }}.png" alt="–ü–æ–≥–æ–¥–∞">
    </div>
    {% endfor %}

    <script>
        function trackCityClick(cityName, cityId) {
            fetch('/track-click/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify({
                    product_id: cityId,
                    product_name: cityName
                })
            });
        }

        function trackButtonClick(buttonName) {
            fetch('/track-click/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify({
                    button_name: buttonName
                })
            });
        }

        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            trackButtonClick('–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
        });
    </script>
</body>
</html>